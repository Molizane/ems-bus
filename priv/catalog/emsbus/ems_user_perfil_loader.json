{
    "name": "ems_user_perfil_loader",
	"comment": "Catalog for ems_user_perfil_loader",
	"owner": "emsbus",
	"version": "1",
	"service" : "ems_user_perfil_loader:start",
	"url": "/emsbus/ems_user_perfil_loader",
	"async": "false",
	"type": "KERNEL",
	"lang" : "erlang",
	"update_checkpoint" : 65000,
	"datasource" : "ds_ems_user_loader",	
	"pool_size" : 1,
	"pool_max" : 1,
	"enable" : false,
	"sql_load_perfil" : 
			 "select u.UsuPesIdPessoa as UserId,
				p.PerId,
				p.PerNome,
				p.PerDescricao
			from BDAcesso.dbo.TB_Usuario u join BDAcesso.dbo.TB_Acessos_Perfil up  
									on u.UsuId = up.APeUsuId 
					inner join BDAcesso.dbo.TB_Perfil p 
									on up.APePerId = p.PerId
			group by u.UsuPesIdPessoa, p.PerId, p.PerNome, p.PerDescricao
			order by u.UsuPesIdPessoa
		  ",
		  
	"sql_update_perfil" :
			"select u.UsuPesIdPessoa as UserId,
				p.PerId,
				p.PerNome,
				p.PerDescricao
			from BDAcesso.dbo.TB_Usuario u join BDAcesso.dbo.TB_Acessos_Perfil up  
									on u.UsuId = up.APeUsuId 
					inner join BDAcesso.dbo.TB_Perfil p 
									on up.APePerId = p.PerId
			where p.PerDataAlteracao >= ? or up.APeDataAlteracao >= ?
			group by u.UsuPesIdPessoa, p.PerId, p.PerNome, p.PerDescricao
			order by u.UsuPesIdPessoa
			"
}
